<?xml version="1.0" encoding="utf-8"?>
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:app="http://schemas.android.com/apk/res-auto">

    <data>
        <import type="android.view.View"/>
        <import type="com.ustadmobile.port.android.view.PersonDetailFragmentEventHandler"/>
        <import type="com.ustadmobile.port.android.view.ext.StringExtKt"/>

        <variable
            name="person"
            type="com.ustadmobile.lib.db.entities.Person" />

        <variable
            name="loading"
            type="boolean" />

        <variable
            name="fieldsEnabled"
            type="boolean" />

        <variable
            name="editButtonMode"
            type="com.ustadmobile.core.view.EditButtonMode"/>

        <variable
            name="fragmentEventHandler"
            type="PersonDetailFragmentEventHandler" />

    </data>

    <androidx.core.widget.NestedScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        app:layout_behavior="@string/appbar_scrolling_view_behavior">

        <androidx.constraintlayout.widget.ConstraintLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content">

            <androidx.appcompat.widget.AppCompatImageView
                android:id="@+id/fragment_person_detail_picture_imageview"
                android:layout_width="match_parent"
                android:layout_height="@dimen/dimen_256dp"
                android:scaleType="centerCrop"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toTopOf="parent"
                app:personPicturePersonUid="@{person.personUid}"
                app:personPictureVisibilityGoneIfNoPicture="@{true}"/>

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/fragment_person_detail_picture_image_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_picture_imageview"
                tools:layout_editor_absoluteY="256dp" />

            <!-- This could be replaced with a MaterialButton when the PR accepting top aligned icon is accepted
            https://github.com/material-components/material-components-android/pull/1129 -->
            <!-- Note we cannot use a compound drawable because this would not work with vector
            drawable on Android 4.4 and below -->
            <LinearLayout
                android:id="@+id/fragment_person_detail_call_linlayout"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.phoneNum)}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:paddingHorizontal="16dp"
                android:paddingVertical="8dp"
                android:background="@drawable/bg_listitem"
                app:onClickDial="@{person.phoneNum}"
                android:orientation="vertical"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_picture_image_barrier"
                tools:ignore="UseCompoundDrawables">


                <ImageView
                    android:id="@+id/fragment_person_detail_call_icon_imageview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    app:srcCompat="@drawable/ic_phone_black_24dp" />

                <TextView
                    android:id="@+id/fragment_person_detail_call_text"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/call" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/fragment_person_detail_text_linlayout"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.phoneNum)}"
                app:onClickSms="@{person.phoneNum}"
                android:background="@drawable/bg_listitem"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:paddingHorizontal="16dp"
                android:paddingVertical="8dp"
                android:orientation="vertical"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_call_linlayout"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_picture_image_barrier">

                <androidx.appcompat.widget.AppCompatImageView
                    android:id="@+id/fragment_person_text_icon"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    app:tint="@color/text_primary"
                    app:srcCompat="@drawable/ic_message_bcd4_24dp" />

                <TextView
                    android:id="@+id/fragment_person_detail_text_textview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/text" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/fragment_person_detail_email_linlayout"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.emailAddr)}"
                app:onClickEmail="@{person.emailAddr}"
                android:background="@drawable/bg_listitem"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:paddingHorizontal="16dp"
                android:paddingVertical="8dp"
                android:orientation="vertical"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_text_linlayout"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_picture_imageview"
                tools:ignore="UseCompoundDrawables">

                <ImageView
                    android:id="@+id/fragment_person_detail_email_image"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    app:srcCompat="@drawable/ic_email_black_24dp" />

                <TextView
                    android:id="@+id/textView35"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/email" />
            </LinearLayout>

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/fragment_person_detail_buttonbar_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_call_linlayout,fragment_person_detail_text_linlayout,fragment_person_detail_email_linlayout"
                />

            <View
                android:id="@+id/divider"
                android:layout_width="match_parent"
                android:layout_height="1dp"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_buttonbar_barrier"
                app:layout_constraintStart_toStartOf="parent"
                android:background="?android:attr/listDivider" />

            <TextView
                android:id="@+id/fragment_person_detail_header_basicdetails_text"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:layout_marginTop="8dp"
                android:text="@string/basic_details"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_buttonbar_barrier" />



            <ImageView
                android:id="@+id/fragment_person_detail_dob_imageview"
                android:visibility="@{person.dateOfBirth != 0 ? View.VISIBLE : View.GONE}"
                android:layout_width="@dimen/dimen_24dp"
                android:layout_height="@dimen/dimen_24dp"
                android:layout_marginStart="16dp"
                android:layout_marginTop="8dp"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_header_basicdetails_text"
                app:srcCompat="@drawable/ic_event_black_24dp" />

            <TextView
                android:id="@+id/fragment_person_detail_dob_valuetext"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:layout_marginTop="8dp"
                app:dateLong="@{person.dateOfBirth}"
                android:visibility="@{person.dateOfBirth != 0 ? View.VISIBLE : View.GONE}"
                tools:text="DD/MM/YYYY"
                android:textColor="@color/text_primary"
                android:textSize="@dimen/list_twoline1_textsize_line1"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_dob_imageview"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_header_basicdetails_text" />

            <TextView
                android:id="@+id/fragment_person_detail_dob_fieldnametext"
                android:visibility="@{person.dateOfBirth != 0 ? View.VISIBLE : View.GONE}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:text="@string/birthday"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_dob_imageview"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_dob_valuetext" />

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/fragment_person_detail_dob_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_dob_fieldnametext,fragment_person_detail_header_basicdetails_text" />

            <TextView
                android:id="@+id/fragment_person_detail_gender_valuetext"
                android:visibility="@{person.gender != 0 ? View.VISIBLE : View.GONE}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginVertical="8dp"
                android:layout_marginStart="48dp"
                app:textPersonGender="@{person.gender}"
                android:textColor="@color/text_primary"
                android:textSize="@dimen/list_twoline1_textsize_line1"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_dob_barrier"
                tools:text="Male/Female" />

            <TextView
                android:id="@+id/fragment_person_detail_gender_fieldnametext"
                android:visibility="@{person.gender != 0 ? View.VISIBLE : View.GONE}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/gender_literal"
                app:layout_constraintStart_toStartOf="@+id/fragment_person_detail_gender_valuetext"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_gender_valuetext" />

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/fragment_person_detail_gender_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_gender_fieldnametext,fragment_person_detail_dob_barrier" />

            <ImageView
                android:id="@+id/fragment_person_detail_orgid_imageview"
                android:visibility="@{person.personOrgId != null ? View.VISIBLE : View.GONE}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="16dp"
                android:layout_marginTop="8dp"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_gender_barrier"
                app:srcCompat="@drawable/ic_badge_24dp" />

            <TextView
                android:id="@+id/fragment_person_detail_orgid_valuetext"
                android:visibility="@{person.personOrgId != null ? View.VISIBLE : View.GONE}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:layout_marginTop="8dp"
                android:text="@{person.personOrgId}"
                android:textColor="@color/text_primary"
                android:textSize="@dimen/list_twoline1_textsize_line1"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_orgid_imageview"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_gender_barrier"
                tools:text="RA-007" />

            <TextView
                android:id="@+id/fragment_person_detail_orgid_fieldnametext"
                android:visibility="@{person.personOrgId != null ? View.VISIBLE : View.GONE}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:text="@string/organization_id"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_orgid_imageview"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_orgid_valuetext" />

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/fragment_person_detail_orgid_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_gender_barrier,fragment_person_detail_orgid_fieldnametext" />

            <ImageView
                android:id="@+id/fragment_person_detail_username_imageview"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.username)}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="16dp"
                android:layout_marginTop="8dp"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_orgid_barrier"
                app:srcCompat="@drawable/ic_account_circle_black_24dp" />

            <TextView
                android:id="@+id/fragment_person_detail_username_valuetext"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.username)}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:layout_marginTop="8dp"
                android:text="@{person.username}"
                tools:text="user.name"
                android:textColor="@color/text_primary"
                android:textSize="@dimen/list_twoline1_textsize_line1"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_username_imageview"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_orgid_barrier" />

            <TextView
                android:id="@+id/fragment_person_detail_username_fieldnametext"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.username)}"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:text="@string/username"
                app:layout_constraintStart_toEndOf="@+id/fragment_person_detail_username_imageview"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_username_valuetext" />

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/fragment_person_detail_username_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_username_fieldnametext,fragment_person_detail_orgid_barrier"
                tools:layout_editor_absoluteY="528dp" />

            <TextView
                android:id="@+id/fragment_person_detail_contact_details_header_textview"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:layout_marginTop="8dp"
                android:text="@string/contact_details"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_username_barrier" />

            <androidx.constraintlayout.widget.ConstraintLayout
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.phoneNum)}"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_contact_details_header_textview"
                app:onClickDial="@{person.phoneNum}"
                android:background="@drawable/bg_listitem"
                android:id="@+id/phonenum_constraintlayout"
                android:layout_width="match_parent"
                android:layout_height="match_parent">

                <ImageView
                    android:id="@+id/fragment_person_details_phonenum_imageview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="16dp"
                    android:layout_marginTop="8dp"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:srcCompat="@drawable/ic_phone_black_24dp" />

                <TextView
                    android:id="@+id/phone_num_textview"
                    android:textColor="@color/text_primary"
                    android:textSize="@dimen/list_twoline1_textsize_line1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="8dp"
                    android:layout_marginTop="8dp"
                    android:text="@{person.phoneNum}"
                    tools:text="+1 234 567 8910"
                    app:layout_constraintStart_toEndOf="@+id/fragment_person_details_phonenum_imageview"
                    app:layout_constraintTop_toTopOf="parent" />

                <TextView
                    android:id="@+id/phone_num_fieldname_text"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="8dp"
                    android:text="@string/phone"
                    app:layout_constraintStart_toEndOf="@+id/fragment_person_details_phonenum_imageview"
                    app:layout_constraintTop_toBottomOf="@+id/phone_num_textview" />

                <com.google.android.material.button.MaterialButton
                    android:id="@+id/phone_num_message_imageview"
                    app:onClickSms="@{person.phoneNum}"
                    android:layout_width="40dp"
                    android:layout_height="40dp"
                    android:layout_marginTop="8dp"
                    android:layout_marginEnd="16dp"
                    app:layout_constraintEnd_toEndOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    style="@style/Widget.MaterialComponents.Button.TextButton.Icon"
                    app:iconGravity="textStart"
                    app:icon="@drawable/ic_message_bcd4_24dp"
                    app:iconTint="@color/text_primary"
                    app:iconPadding="0dp"
                    />

            </androidx.constraintlayout.widget.ConstraintLayout>



            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/fragment_person_detail_phonenum_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_contact_details_header_textview,phonenum_constraintlayout"
                 />



            <androidx.constraintlayout.widget.ConstraintLayout
                android:id="@+id/email_constraintlayout"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/fragment_person_detail_phonenum_barrier"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.emailAddr)}"
                app:onClickEmail="@{person.emailAddr}"
                android:background="@drawable/bg_listitem"
                >

                <ImageView
                    android:id="@+id/email_icon_imageview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="16dp"
                    android:layout_marginTop="8dp"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:srcCompat="@drawable/ic_email_black_24dp" />

                <TextView
                    android:id="@+id/email_value_text"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="8dp"
                    android:layout_marginTop="8dp"
                    android:text="@{person.emailAddr}"
                    tools:text="user@email.com"
                    android:textColor="@color/text_primary"
                    android:textSize="@dimen/list_twoline1_textsize_line1"
                    app:layout_constraintStart_toEndOf="@+id/email_icon_imageview"
                    app:layout_constraintTop_toTopOf="parent" />

                <TextView
                    android:id="@+id/email_fieldname_text"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="8dp"
                    android:text="@string/email"
                    app:layout_constraintStart_toEndOf="@+id/email_icon_imageview"
                    app:layout_constraintTop_toBottomOf="@+id/email_value_text" />

            </androidx.constraintlayout.widget.ConstraintLayout>

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/email_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="fragment_person_detail_phonenum_barrier,email_constraintlayout"
                />

            <androidx.constraintlayout.widget.ConstraintLayout
                android:id="@+id/address_constraintlayout"
                app:layout_constraintTop_toBottomOf="@+id/email_barrier"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:visibility="@{StringExtKt.visibleIfNotNullOrEmpty(person.personAddress)}"
                >

                <ImageView
                    android:id="@+id/address_icon_imageview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="16dp"
                    android:layout_marginTop="8dp"
                    app:layout_constraintStart_toStartOf="parent"
                    app:layout_constraintTop_toTopOf="parent"
                    app:srcCompat="@drawable/ic_location_pin_24dp" />

                <TextView
                    android:id="@+id/address_value_textview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:textColor="@color/text_primary"
                    android:textSize="@dimen/list_twoline1_textsize_line1"
                    android:layout_marginStart="8dp"
                    android:layout_marginTop="8dp"
                    android:text="@{person.personAddress}"
                    app:layout_constraintStart_toEndOf="@+id/address_icon_imageview"
                    app:layout_constraintTop_toTopOf="parent"
                    tools:text="123 Street Name" />

                <TextView
                    android:id="@+id/address_fieldname_textview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginStart="8dp"
                    android:text="@string/address"
                    app:layout_constraintStart_toEndOf="@+id/address_icon_imageview"
                    app:layout_constraintTop_toBottomOf="@+id/address_value_textview" />
            </androidx.constraintlayout.widget.ConstraintLayout>

            <androidx.constraintlayout.widget.Barrier
                android:id="@+id/address_barrier"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                app:barrierDirection="bottom"
                app:constraint_referenced_ids="email_barrier,address_constraintlayout"
                />

            <TextView
                android:id="@+id/classes_heading_textview"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginStart="8dp"
                android:layout_marginTop="8dp"
                android:text="@string/classes"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/address_barrier" />

            <androidx.recyclerview.widget.RecyclerView
                android:id="@+id/classes_recyclerview"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="8dp"
                app:layout_constraintEnd_toEndOf="parent"
                app:layout_constraintStart_toStartOf="parent"
                app:layout_constraintTop_toBottomOf="@+id/classes_heading_textview"
                tools:itemCount="2"
                tools:listitem="@layout/item_clazz_member_with_clazz_detail"
                tools:visibility="visible" />

        </androidx.constraintlayout.widget.ConstraintLayout>



    </androidx.core.widget.NestedScrollView>




</layout>
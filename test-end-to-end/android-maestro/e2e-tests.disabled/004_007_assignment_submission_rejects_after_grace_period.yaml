appId: com.toughra.ustadmobile
tags:
  - checklist4
env:
  TESTRESULTSDIR: "${TESTRESULTSDIR}/004_007_assignment_submission_after_graceperiod"
  TESTNAME: "004_007_assignment_submission_after_graceperiod"
---
- clearState: com.toughra.ustadmobile
- clearState: com.toughra.ustadmobile2
- runFlow:
    file: "../common/startserver.yaml"
    env:
      CONTROLSERVER: ${CONTROLSERVER}
      TESTSERIAL: ${TESTSERIAL}
      TESTNAME: ${TESTNAME}
# admin able to add a course and edit that course
- runFlow: "../build/common-app2/clear_state_and_get_started.yaml"
- runFlow: "../build/common-app2/select_site.yaml"
- - runFlow:
    file: "../build/common-app2/user_login.yaml"
- runFlow:
    file: "../build/common-app2/create_course_with_1teacher_1student.yaml"
    env:
      TESTCOURSENAME: Test Course
- runFlow: "../common/clear_state_and_get_started.yaml"
- runFlow: "../common/select_site.yaml"
- runFlow:
    file: "../common/user_login.yaml"
    env:
      USERNAME: t1
      PASSWORD: test
appId: com.toughra.ustadmobile
---
# this test add an assignment block on a course with deadline and grace period
# Test parameters needs to provide for this test :
# 1) TESTCOURSENAME: provide course name of string type
# 2) ASSIGNMENTNAME: provide assignment name of string type
- tapOn: "Courses"
- tapOn: "Test Course"
- tapOn: "Edit"
- repeat:
    while:
      notVisible: "Add block"
    commands:
      - scroll
- tapOn: "Add block"
- tapOn: "Assignments"
- tapOn: "Title"
- inputText: "Test Assignment"
- tapOn: "Description (Optional)"
- inputText: "Test "
- hideKeyboard
- tapOn: "Completion criteria"
- tapOn: "Submitted"
- tapOn: "Deadline (Optional)"
- tapOn: "OK"
- tapOn:
    text: "Time"
    index: 1
- tapOn: "OK"
- repeat:
    while:
      notVisible:
        id: "com.toughra.ustadmobile:id/ca_edit_penalty"
    commands:
- tapOn: "End of grace period"
- tapOn: "OK"
- tapOn:
    text: "Time"
    index: 2
- tapOn: "Switch to text input mode for the time input."
- tapOn:
    id: "android:id/input_hour"
- runScript: settime_hr.js
- inputText: ${output.settime_hr.result}
- tapOn:
    id: "android:id/input_minute"
- runScript: settime_min.js
- inputText: ${output.settime_min.result}
- tapOn: "OK"
- tapOn:
    id: "com.toughra.ustadmobile:id/ca_edit_penalty"
- eraseText
- inputText: "10"
- tapOn: "DONE"
- tapOn: "SAVE"

#-------------------------------------------------------------------------student submit assignment
- runFlow: "../build/common-app2/clear_state_and_get_started.yaml"
- runFlow: "../build/common-app2/select_site.yaml"
- runFlow:
    file: "../build/common-app2/user_login.yaml"
    env:
      USERNAME: s1
      PASSWORD: test
- runFlow:
    file: "../build/common-app2/student_try_submit_assignment_just_before_deadline.yaml"
    env:
      ASSIGNMENTNAME: Test Assignment
      TESTCOURSENAME: Test Course
      TEXT: Numbers - 1,2,3,4,5,6,7,8,9,10 Alphabets - A B C D E F G H I J K L M N O P Q R S T U V W X Y Z
- runFlow: "../common/clear_state_and_get_started.yaml"
- runFlow: "../common/select_site.yaml"
#teacher login
- runFlow:
    file: "../common/user_login.yaml"
    env:
      USERNAME: t1
      PASSWORD: test